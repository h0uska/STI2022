# https://www.youtube.com/watch?v=g8tdrB3kbDU
name: CI/CD
#on:
  push:
    branches: [ main ]
  #pull_request:
    #branches: [ main ]
  # Allows you to run this workflow manually from the Actions tab
  #workflow_dispatch:
jobs:
  build:
    runs-on: windows-latest
    steps:
    
      - uses: actions/checkout@v3 # kopíruje a checkuje kód
      
      - name: Add msbuild to PATH
        uses: microsoft/setup-msbuild@v1.1
        
      #- name: Build app for release
      #  run: msbuild Klient/Klient.csproj -t:rebuild -verbosity:diag -property:Configuration=Release
      
      - name: Setup NuGet #jméno volitelné
        uses: NuGet/setup-nuget@v1.0.6
        
      - name: Restore NuGet packages
        run: nuget restore Klient/Klient.sln
        
      - name: Build the solution
        run: msbuild Klient/Klient.sln
        
        
        
        
        
        
      - name: Set up and run Cavalry
        # You may pin to the exact commit or the version.
        # uses: gblach/cavalry-action@be57765ac102738382cabb33266f28e89b97253b
        uses: gblach/cavalry-action@v1
        
        
      - name: Test Reporter
        # You may pin to the exact commit or the version.
        # uses: dorny/test-reporter@0d00bb14cb0cc2c9b8985df6e81dd333188224e1
        uses: dorny/test-reporter@v1.5.0
      
      - name: Run a one-line script
        run:  '& "$(vswhere -property installationPath)\Common7\IDE\MSTest.exe" /help'
        
      - name: Execute unit tests
        run: dotnet test
        
        
